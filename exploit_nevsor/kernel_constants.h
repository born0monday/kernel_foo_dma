#define PAGE_SHIFT		12
#define PAGE_SIZE		4096
#define PAGE_MASK		(~(PAGE_SIZE-1))
#define INV_PAGE_MASK   (PAGE_SIZE-1)

#define __START_KERNEL_map (0xffffffff80000000)
#define PHYSICAL_START (0x1000000)
#define TEXT_SEGMENT_START (0xffffffff81000000 - __START_KERNEL_map)

#define ADDR_ANON_PIPE_BUF_OPS (0xffffffff8201acc0 - __START_KERNEL_map)
#define ADDR_INIT_TASK (0xffffffff82414940 - __START_KERNEL_map)
#define ADDR_LINUX_BANNER (0xffffffff820001a0 - __START_KERNEL_map)

#define OFFSET_CRED_IN_TASK_STRUCT (0x658)
#define OFFSET_REAL_CRED_IN_TASK_STRUCT (OFFSET_CRED_IN_TASK_STRUCT - sizeof(void*))
// #define OFFSET_COMM_IN_TASK_STRUCT (0x498)
#define OFFSET_COMM_IN_TASK_STRUCT (OFFSET_CRED_IN_TASK_STRUCT + 0x10)
#define OFFSET_SCHEDINFO_IN_TASK_STRUCT (0x378)
#define OFFSET_PUSHABLE_TASK_IN_TASK_STRUCT (0x3c0) // +- a few pointers
#define SIZEOF_SCHEDINFO (0x20)
#define OFFSET_TASKS_IN_TASK_STRUCT (OFFSET_SCHEDINFO_IN_TASK_STRUCT+SIZEOF_SCHEDINFO)
#define OFFSET_PID_IN_TASK_STRUCT (0x498)
#define OFFSET_TGID_IN_TASK_STRUCT (0x49c)

#define OFFSET_NEXT_IN_LIST_HEAD (0)
#define OFFSET_PREV_IN_LIST_HEAD (sizeof(void*))

#define ADDR_PHYS_BASE (0xffffffff82414010 - __START_KERNEL_map)
#define ADDR_PAGE_OFFSET_BASE (0xffffffff822e6450 - __START_KERNEL_map)
#define ADDR_VMALLOC_BASE (0xffffffff822e6448 - __START_KERNEL_map)
#define ADDR_VMEMMAP_BASE (0xffffffff822e6440 - __START_KERNEL_map)

#define SIZEOF_PAGE_STRUCT (0x40)

#define MIN_KERNEL_ALIGN (1<<21)

#define KERNEL_IMAGE_FIRST_QWORD (0x4801403f51258d48)